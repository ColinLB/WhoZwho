<!--
Copyright (C) 2012 C. R. Leavett-Brown
You may distribute under the terms of either the GNU General Public
License or the Apache v2 License, as specified in the README file.
-->

{% extends "SessionUnauthenticated.html" %}

{% block headers %}
    <script src="{{ ZS.httpURL }}static/js/Security.js" type="text/javascript"></script>

    <script type="text/javascript">
        function SubmitForm() {
            error = CheckPassword(
                document.getElementById("id_password").value, 
                document.getElementById("id_vpassword").value
                );

            if (error == "") document.forms["UserChangePassword"].submit();

            document.getElementById("error_message").innerHTML = error;
        }
    </script>
{% endblock %}

{% block body %}
    <form id="UserChangePassword" action="/WhoZwho/chpwd/{{ browser_tab }}" method="post">
        {% csrf_token %}
        <p id=page_title>Changing Password for Login ID: {{ ZS.User }}</p>

        <ul>
            <li><p>All fields are required. Passwords must be 6 to 16 mixed lowercase, uppercase,
                numeric, and special characters (at least 3 of the 4 types), and must not contain
                recognizeable sequences; e.g. "abc", "123", "qwerty", etc.</p></li>
        </ul>

        <table>
          <tr>
            <td class="left_margin"></td>
            <td id="error_message" class="error_message">{{ ZS.ErrorMessage }}</td>
          </tr>
        </table>

        <table>
          <tr>
            <td class="left_margin"></td>
            <td><label for="id_password">Choose a new Password:</label></td>
            <td><input id="id_password" tabindex="5" type="password" name="password" maxlength="16" value="{{ form.cleaned_data.password }}" /></td>
          </tr><tr>
            <td></td>
            <td><label for="id_vpassword">Verify new password:</label></td>
            <td><input id="id_vpassword" tabindex="6" type="password" name="vpassword" maxlength="16" value="{{ form.cleaned_data.vpassword }}" /></td>
          </tr><tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td><input type="button" value="Submit" onclick="SubmitForm();" /></td>
          </tr>
        </table>

        {% if ZS.Authority > 0 %}
            <ul>
              <li><p>Use browser back button to cancel password change.</p></li>
            </ul>
        {% endif %}
    </form>
{% endblock %}
